{"version":3,"file":"loader.min.js","sources":["../src/loader.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Easychem JS Loader.\n *\n * @module     filter_easychem/loader\n * @copyright  2014 Carl LeBlond, 2025 Andrey Smirnov\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery'], function($) {\n    return {\n        /**\n         * Called by the filter when an equation is found while rendering the page.\n         *\n         * @method typeset\n         */\n        typeset: function() {\n            // Wait for DOM to be ready and easychem to be loaded\n            $(document).ready(function() {\n                $('.echem-formula').each(function() {\n                    var node = $(this);\n                    var src = node.html();\n\n                    // Take care of problem with | character and replace problem!\n                    var str = src.split(\"|\");\n                    console.log(str); // Consider replacing with proper logging\n\n                    for(var i = 0; i < str.length; i++) {\n                        str[i] = str[i].replace(\"&gt;\", \">\").replace(\"&lt;\",\"<\");\n                    }\n                    src = str.join(\"|\");\n\n                    // Check if ChemSys is available\n                    if (typeof ChemSys !== 'undefined') {\n                        var res = ChemSys.compile(src);\n                        node.empty();\n                        ChemSys.draw(node[0], res);\n                    } else {\n                        console.error('Easychem ChemSys not loaded');\n                    }\n                });\n            });\n        }\n    };\n});\n"],"names":["define","$","typeset","document","ready","each","node","this","src","html","str","split","console","log","i","length","replace","join","ChemSys","res","compile","empty","draw","error"],"mappings":";;;;;;;AAuBAA,gCAAO,CAAC,WAAW,SAASC,SACjB,CAMHC,QAAS,WAELD,EAAEE,UAAUC,OAAM,WACdH,EAAE,kBAAkBI,MAAK,eACjBC,KAAOL,EAAEM,MACTC,IAAMF,KAAKG,OAGXC,IAAMF,IAAIG,MAAM,KACpBC,QAAQC,IAAIH,SAER,IAAII,EAAI,EAAGA,EAAIJ,IAAIK,OAAQD,IAC3BJ,IAAII,GAAKJ,IAAII,GAAGE,QAAQ,OAAQ,KAAKA,QAAQ,OAAO,QAExDR,IAAME,IAAIO,KAAK,KAGQ,oBAAZC,QAAyB,KAC5BC,IAAMD,QAAQE,QAAQZ,KAC1BF,KAAKe,QACLH,QAAQI,KAAKhB,KAAK,GAAIa,UAEtBP,QAAQW,MAAM"}